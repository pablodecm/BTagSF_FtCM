
from mut_framework.BTagSF_FtCM.FtCM_formula import multiset, submultiset
from mut_framework.BTagSF_FtCM.FtCM_formula import prob_component, prob_submultiset

from mut_framework.BTagSF_FtCM.FtCM_formula import formula_categories

print "multiset(1,2) = " + str(multiset(1,2))
print "multiset(2,3) = " + str(multiset(2,3))
print "multiset(3,3) = " + str(multiset(3,3))
print "multiset(3,1) = " + str(multiset(3,1))
print "submultiset((1,1,1),3) = " + str(submultiset((1,1,1),3))
print "submultiset((3,3,3),3) = " + str(submultiset((3,3,3),3))
print "submultiset((1,1,2),1) = " + str(submultiset((1,1,2),1))

print "prob_component((1,0,0),(1,1,2)) = " +str(prob_component((1,0,0),(1,1,2))) 
print "prob_component((0,1,0),(1,1,2)) = " +str(prob_component((0,1,0),(1,1,2))) 
print "prob_component((0,0,1),(1,1,2)) = " +str(prob_component((0,0,1),(1,1,2))) 
print "prob_submultiset((1,1,2), 1) = " +str(prob_submultiset((1,1,2), 1)) 
print "prob_submultiset((1,1,2), 1).expand() = " + str(prob_submultiset((1,1,2), 1).expand()) 
print "prob_submultiset((1,1,2,1,1), 2).expand() = " + str(prob_submultiset((1,1,2,1,1), 2).expand()) 

cat_fractions = {(1, 4, 0, 2): 0.0013532645833240287, (0, 4, 1, 1): 0.008164249697413611, (2, 5, 0, 0): 4.466219746943989e-06, (0, 2, 0, 4): 0.000419824656212735, (0, 4, 1, 2): 0.01142012389293578, (0, 2, 2, 1): 0.002791387341839993, (3, 1, 0, 0): 8.932439493887979e-06, (1, 1, 0, 3): 0.0002411758663349754, (0, 6, 0, 0): 0.0004376895352005109, (2, 3, 1, 1): 5.806085671027186e-05, (2, 1, 0, 1): 0.0003260340415269112, (0, 1, 0, 5): 4.466219746943989e-06, (1, 1, 2, 2): 0.00010272305417971175, (2, 1, 2, 1): 4.466219746943989e-06, (0, 1, 0, 3): 0.003733759708445175, (2, 1, 2, 2): 8.932439493887979e-06, (2, 4, 0, 0): 1.3398659240831967e-05, (1, 5, 0, 1): 0.000415358436465791, (1, 2, 2, 1): 2.6797318481663935e-05, (0, 5, 2, 0): 3.5729757975551915e-05, (1, 2, 0, 4): 1.3398659240831967e-05, (0, 0, 4, 1): 4.466219746943989e-06, (1, 2, 0, 1): 0.005649767979884146, (1, 3, 1, 2): 0.000835183092678526, (0, 5, 0, 0): 0.0018802785134634193, (0, 0, 2, 2): 0.003318401271979384, (1, 2, 0, 2): 0.00802579688525835, (3, 2, 0, 1): 2.2331098734719944e-05, (0, 2, 1, 4): 0.00021437854785331148, (2, 0, 2, 2): 8.932439493887979e-06, (0, 0, 0, 4): 0.00018311500962470357, (0, 4, 2, 0): 9.825683443276776e-05, (0, 2, 3, 1): 0.00018758122937164755, (0, 2, 3, 2): 0.00033496648102079917, (1, 4, 2, 0): 4.466219746943989e-06, (0, 4, 0, 0): 0.0056899639576066426, (1, 3, 0, 2): 0.0034479216446407597, (2, 3, 0, 1): 0.00012952037266137568, (0, 4, 0, 3): 0.0011165549367359972, (2, 3, 0, 2): 0.0002813718440574713, (0, 3, 4, 0): 8.932439493887979e-06, (0, 1, 2, 4): 8.932439493887979e-06, (0, 1, 3, 3): 2.2331098734719944e-05, (2, 3, 1, 0): 8.932439493887979e-06, (0, 3, 0, 3): 0.0017909541185245396, (0, 1, 1, 2): 0.14218657186370884, (0, 1, 2, 2): 0.005444321871524722, (0, 1, 1, 5): 4.466219746943989e-06, (2, 2, 0, 2): 0.0002947705032983033, (0, 3, 2, 0): 0.00025904074532275137, (3, 0, 0, 1): 1.7864878987775958e-05, (0, 0, 1, 4): 0.00010718927392665574, (1, 2, 1, 0): 0.00019651366886553552, (3, 0, 0, 2): 6.699329620415983e-05, (0, 2, 4, 0): 8.932439493887979e-06, (0, 5, 1, 1): 0.003389860787930488, (1, 2, 1, 3): 3.1263538228607925e-05, (0, 4, 0, 1): 0.030280969884280248, (1, 3, 1, 0): 7.592573569804781e-05, (1, 4, 0, 0): 0.00017418257013081557, (0, 2, 2, 0): 0.00047788551292300685, (0, 2, 2, 3): 0.00010272305417971175, (3, 1, 0, 2): 6.699329620415983e-05, (0, 1, 4, 0): 4.466219746943989e-06, (1, 1, 0, 2): 0.015872944980638938, (0, 1, 2, 3): 6.252707645721585e-05, (4, 1, 0, 2): 1.7864878987775958e-05, (2, 1, 0, 2): 0.0004957503919107828, (1, 1, 0, 4): 4.466219746943989e-05, (1, 1, 2, 1): 9.825683443276776e-05, (1, 5, 0, 0): 5.806085671027186e-05, (1, 2, 2, 2): 0.0001205879331674877, (2, 4, 1, 0): 4.466219746943989e-06, (2, 2, 1, 0): 8.932439493887979e-06, (0, 3, 1, 2): 0.029494915208818105, (0, 0, 4, 0): 4.466219746943989e-06, (0, 3, 1, 1): 0.02423817456666503, (0, 5, 0, 1): 0.009254007315667945, (1, 2, 0, 3): 0.00013398659240831967, (2, 0, 0, 2): 0.0005002166116577268, (0, 5, 0, 2): 0.013876544753754974, (0, 3, 3, 1): 0.0002054461083594235, (3, 2, 0, 2): 4.912841721638388e-05, (1, 0, 1, 3): 8.932439493887979e-06, (0, 2, 1, 2): 0.07765416274011513, (1, 6, 0, 0): 3.1263538228607925e-05, (1, 3, 2, 1): 3.1263538228607925e-05, (1, 0, 3, 2): 4.466219746943989e-06, (0, 3, 0, 2): 0.11053893873686373, (3, 1, 1, 0): 4.466219746943989e-06, (1, 1, 1, 4): 8.932439493887979e-06, (1, 3, 0, 1): 0.002425157322590586, (1, 4, 1, 1): 0.0002501083058288634, (1, 1, 1, 1): 0.0014783187362384603, (0, 3, 0, 1): 0.08398279612153477, (0, 6, 1, 0): 0.00026797318481663933, (1, 1, 3, 1): 1.7864878987775958e-05, (3, 3, 0, 1): 1.7864878987775958e-05, (0, 1, 3, 2): 0.0003885611179841271, (1, 1, 3, 2): 4.466219746943989e-06, (0, 1, 3, 1): 0.00025457452557580735, (0, 4, 0, 2): 0.03686417779127569, (0, 3, 0, 4): 0.0003438989205146872, (2, 2, 2, 1): 8.932439493887979e-06, (0, 3, 1, 3): 0.0006743991817885423, (0, 1, 1, 4): 0.0001563176911430396, (2, 2, 0, 1): 0.00017864878987775955, (0, 3, 2, 1): 0.0014470551980098525, (2, 0, 1, 1): 4.912841721638388e-05, (0, 0, 3, 3): 8.932439493887979e-06, (0, 3, 2, 2): 0.002036596204606459, (1, 0, 0, 3): 0.0002858380638044153, (1, 2, 1, 2): 0.0013800619018056925, (4, 2, 0, 1): 8.932439493887979e-06, (0, 0, 3, 2): 0.0001652501306369276, (2, 0, 3, 2): 4.466219746943989e-06, (0, 0, 3, 1): 0.00010718927392665574, (0, 4, 3, 0): 1.7864878987775958e-05, (0, 2, 0, 3): 0.0035506446988204715, (1, 3, 1, 1): 0.0005672099078618866, (1, 4, 0, 1): 0.0008575141914132459, (0, 4, 1, 0): 0.0017150283828264918, (0, 2, 0, 5): 1.7864878987775958e-05, (0, 2, 2, 2): 0.0033943270076774315, (3, 1, 0, 1): 4.0195977722495905e-05, (0, 1, 4, 2): 3.1263538228607925e-05, (0, 6, 0, 1): 0.003840948982371831, (0, 1, 2, 1): 0.004050861310478198, (0, 1, 0, 4): 0.0004510881944413429, (1, 1, 2, 0): 1.3398659240831967e-05, (1, 1, 2, 3): 4.466219746943989e-06, (0, 5, 1, 0): 0.00044215575494745493, (2, 4, 0, 1): 8.039195544499181e-05, (2, 2, 1, 1): 6.699329620415983e-05, (1, 2, 2, 0): 8.932439493887979e-06, (2, 2, 1, 2): 0.0001652501306369276, (0, 3, 1, 0): 0.004868179524168948, (0, 0, 4, 2): 4.466219746943989e-06, (0, 0, 2, 3): 3.5729757975551915e-05, (0, 3, 3, 0): 1.3398659240831967e-05, (3, 0, 1, 2): 4.466219746943989e-06, (1, 0, 1, 2): 0.0013800619018056925, (2, 0, 2, 0): 4.466219746943989e-06, (1, 0, 1, 4): 4.466219746943989e-06, (0, 0, 0, 5): 4.466219746943989e-06, (1, 3, 2, 0): 1.3398659240831967e-05, (0, 4, 2, 1): 0.000830716872931582, (0, 2, 3, 0): 2.2331098734719944e-05, (1, 3, 0, 0): 0.00033496648102079917, (3, 1, 1, 2): 1.3398659240831967e-05, (1, 4, 1, 0): 2.6797318481663935e-05, (1, 1, 1, 2): 0.0022822382906883786, (1, 3, 0, 3): 8.039195544499181e-05, (2, 3, 0, 0): 2.6797318481663935e-05, (0, 2, 1, 3): 0.0011746157934462691, (2, 1, 1, 2): 0.0001205879331674877, (0, 1, 3, 0): 3.5729757975551915e-05, (2, 1, 1, 1): 0.00011165549367359972, (0, 2, 1, 1): 0.0605932033067891, (1, 5, 1, 0): 1.7864878987775958e-05, (0, 0, 1, 3): 0.0009468385863521257, (0, 1, 1, 3): 0.0017016297235856598, (5, 0, 0, 2): 8.932439493887979e-06, (2, 2, 0, 0): 2.2331098734719944e-05, (2, 0, 1, 2): 8.039195544499181e-05, (2, 2, 0, 3): 1.7864878987775958e-05, (1, 0, 0, 4): 3.5729757975551915e-05, (1, 2, 1, 1): 0.0011433522552176613, (0, 2, 4, 1): 8.932439493887979e-06, (0, 7, 0, 0): 0.0002411758663349754, (1, 0, 2, 1): 3.1263538228607925e-05, (1, 1, 1, 3): 2.6797318481663935e-05, (0, 2, 0, 2): 0.24264078641197304, (1, 0, 2, 2): 9.379061468582377e-05}


print "formula_categories(cat_fractions,1) = " + str(formula_categories(cat_fractions,1))






